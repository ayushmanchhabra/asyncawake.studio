# OS command injection

**Author**: [Ayushman Chhabra](/#/blog/author/Ayushman%20Chhabra)

**Published**: 2025-10-01

**Modified**: 2025-10-18

OS command injection is a vulnerbility which allows an attacker to inject and execute operating system commands on the vulnerable server via the application's input parameter. This may lead to remote code execution, system compromise, privilege escalation, creation of backdoors, lateral movement across the network infrastructure, disruption/takeover of services and misuse of system resources. Beyong technical damage, it causes regulatory, legal and reputational harm.

> Please note, this was an authorized engagement and the vulnerability was disclosed as soon as it was discovered. All sensitive information has been redacted.

## Reconnaissance

Using [`nmap`](https://nmap.org/), an attacker runs an automated scan on the target host.

![OS command injection 1](2025-10-01_1.jpeg)

The attacker observes that the `.git` directory is explosed on the target host. They use [`git-dumper`](https://github.com/arthaud/git-dumper) to dump the Git repository.

![OS command injection 2](2025-10-01_2.jpeg)

The attacker parses through the directories and comes across a file called `check_ping.php`.

![OS command injection 3](2025-10-01_3.jpeg)

The attacker observes the function does not properly validate the input parameter `ip`.

![OS command injection 4](2025-10-01_4.jpeg)

The attacker verifies that this endpoint still exists. The `ping` command's output is returned in the response.

![OS command injection 5](2025-10-01_5.jpeg)

The attacker is able to append commands after the `ping` command and execute it on the system.

## Resource development

After struggling with the web application firewall, the attacker uses [commix](https://github.com/commixproject/commix) to automate the exploitation process.

## Initial access

After some time, the attacker observes that they are able to login to the target system as `apache` user. The terminal output of `cat /etc/passwd` was used as proof of initial access.

![OS command injection 6](2025-10-01_6.jpeg)

## Persistence

The attacker tried to create a bind shell, but commands such as `nc` were blocked.

## Privilege escalation

The attacker tried to escalate their privileges but failed due to the organisation's security policies in place.

## Vulnerability disclosure

As soon as the vulnerability was identified and verified, the client was informed and the vulnerability was patched promptly.
